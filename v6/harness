use Metamodel;
use Op;
use Body;
use Unit;
use Begin;
use JSYNC;
use NAMOutput;
use NieczaFrontendSTD;
use NieczaPassBeta;

my $fe = NieczaFrontendSTD.new(
    lang => 'NULL',
    safemode => False,
    unitname => 'CORE',
    loader => sub ($mn) { die "Module loading NYI" },
);

my %*units;
my $ast = $fe.parse(filename => "RUN.pl", source => slurp("RUN.pl"));
my $mm = $ast.begin;
$mm = NieczaPassBeta.new.run($mm);
my $nstr = NAMOutput.run($mm);

spew "../obj/RUN.nam", $nstr;
